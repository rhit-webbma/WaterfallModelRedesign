/* File generated by: simse.codegenerator.explanatorytoolgenerator.RuleInfoPanelGenerator */
package simse.explanatorytool;

import simse.adts.actions.*;
import simse.explanatorytool.RuleDescriptions;

import javax.swing.*;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;

import javafx.event.EventHandler;
import javafx.scene.control.ListView;
import javafx.scene.control.ScrollPane;
import javafx.scene.control.ScrollPane.ScrollBarPolicy;
import javafx.scene.control.SelectionMode;
import javafx.scene.control.TextArea;
import javafx.scene.control.TitledPane;
import javafx.scene.control.Tooltip;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.Pane;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;

import java.awt.Dimension;

public class RuleInfoPanel extends Pane implements EventHandler<MouseEvent> {
	private simse.adts.actions.Action action; // action in focus

	private ListView triggerRuleList;
	private ListView destroyerRuleList;
	private ListView intermediateRuleList;
	private TextArea descriptionArea; // for displaying a rule description

	public RuleInfoPanel(Stage owner, simse.adts.actions.Action action) {
		this.action = action;

		// Create main panel:
		Pane mainPane = new Pane();
		mainPane.setPrefSize(900, 550);

		// Create rule pane and components:
		VBox rulePane = new VBox();
		TitledPane trigRuleTitlePane = new TitledPane("Trigger Rules:", rulePane);
//		trigRuleTitlePane.add(new JLabel("Trigger Rules:"));
//		rulePane.add(trigRuleTitlePane);

		// rule lists:
		triggerRuleList = new ListView();
		triggerRuleList.setFixedCellSize(7);
//		triggerRuleList.setVisibleRowCount(7);
//		triggerRuleList.setFixedCellWidth(400);
		triggerRuleList.getSelectionModel().setSelectionMode(SelectionMode.SINGLE);
//		triggerRuleList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
//		triggerRuleList.addListSelectionListener(this);
		triggerRuleList.addEventHandler(MouseEvent.MOUSE_CLICKED, this);
		ScrollPane triggerRuleListPane = new ScrollPane(triggerRuleList);
		String trigToolTip = "Rules that execute at the beginning of the action";
		trigRuleTitlePane.setTooltip(new Tooltip(trigToolTip));
//		trigRuleTitlePane.setToolTipText(trigToolTip);
		triggerRuleList.setTooltip(new Tooltip(trigToolTip));
//		rulePane.add(triggerRuleListPane);
		rulePane.getChildren().add(triggerRuleListPane);

		TitledPane destRuleTitlePane = new TitledPane("Destroyer Rules: ", rulePane);
//		destRuleTitlePane.add(new JLabel("Destroyer Rules:"));
//		rulePane.add(destRuleTitlePane);
		destroyerRuleList = new ListView();
		destroyerRuleList.setFixedCellSize(7);
//		destroyerRuleList.setVisibleRowCount(7);
//		destroyerRuleList.setFixedCellWidth(400);
		destroyerRuleList.getSelectionModel().setSelectionMode(SelectionMode.SINGLE);
//		destroyerRuleList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
		destroyerRuleList.addEventHandler(MouseEvent.MOUSE_CLICKED, this);
		ScrollPane destroyerRuleListPane = new ScrollPane(destroyerRuleList);
		String destToolTip = "Rules that execute at the end of the action";
		destRuleTitlePane.setTooltip(new Tooltip(destToolTip));
		destroyerRuleList.setTooltip(new Tooltip(destToolTip));
//		rulePane.add(destroyerRuleListPane);
		rulePane.getChildren().add(destroyerRuleListPane);

		TitledPane intRuleTitlePane = new TitledPane("Intermediate Rules:", rulePane);
//		intRuleTitlePane.add(new JLabel("Intermediate Rules:"));
//		rulePane.add(intRuleTitlePane);
		intermediateRuleList = new ListView();
		intermediateRuleList.setFixedCellSize(7);
//		intermediateRuleList.setVisibleRowCount(7);
//		intermediateRuleList.setFixedCellWidth(400);
//		intermediateRuleList
//				.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
		intermediateRuleList.getSelectionModel().setSelectionMode(SelectionMode.SINGLE);
		intermediateRuleList.addEventHandler(MouseEvent.MOUSE_CLICKED, this);
		ScrollPane intermediateRuleListPane = new ScrollPane(intermediateRuleList);
		String intToolTip = "Rules that execute every clock tick during the life of the action";
		intRuleTitlePane.setTooltip(new Tooltip(intToolTip));
		intermediateRuleList.setTooltip(new Tooltip(intToolTip));
//		rulePane.add(intermediateRuleListPane);
		rulePane.getChildren().add(intermediateRuleListPane);

		initializeRuleLists();

		// description pane:
		VBox descriptionPane = new VBox();
		TitledPane descriptionTitlePane = new TitledPane("Description:", descriptionPane);
//		descriptionTitlePane.add(new JLabel("Description:"));
//		descriptionPane.add(descriptionTitlePane);

		// description text area:
		descriptionArea = new TextArea();
		descriptionArea.setPrefColumnCount(29);
		descriptionArea.setPrefRowCount(30);
		descriptionArea.setWrapText(true);
//		descriptionArea.setLineWrap(true);
//		descriptionArea.setWrapStyleWord(true);
		descriptionArea.setEditable(false);
		ScrollPane descriptionScrollPane = new ScrollPane(descriptionArea);
		descriptionScrollPane.setHbarPolicy(ScrollBarPolicy.NEVER);
		descriptionScrollPane.setVbarPolicy(ScrollBarPolicy.AS_NEEDED);
//		descriptionPane.add(descriptionScrollPane);
		descriptionPane.getChildren().add(descriptionScrollPane);

//		rulePane.add(descriptionPane);
		rulePane.getChildren().add(descriptionPane);

		// Add panes to main pane:
		mainPane.getChildren().add(rulePane);
		mainPane.getChildren().add(descriptionPane);
		this.getChildren().add(mainPane);

//		setOpaque(true);
//		validate();
//		repaint();
	}

	public void valueChanged(ListSelectionEvent e) {
		if ((e.getSource() == triggerRuleList && !triggerRuleList.getSelectionModel()
				.isEmpty())) {
			destroyerRuleList.getSelectionModel().clearSelection();
			intermediateRuleList.getSelectionModel().clearSelection();
			refreshDescriptionArea();
		} else if (e.getSource() == destroyerRuleList
				&& !destroyerRuleList.getSelectionModel().isEmpty()) {
			triggerRuleList.getSelectionModel().clearSelection();
			intermediateRuleList.getSelectionModel().clearSelection();
			refreshDescriptionArea();
		} else if (e.getSource() == intermediateRuleList
				&& !intermediateRuleList.getSelectionModel().isEmpty()) {
			triggerRuleList.getSelectionModel().clearSelection();
			destroyerRuleList.getSelectionModel().clearSelection();
			refreshDescriptionArea();
		}
	}

	private void initializeRuleLists() {
		if (action instanceof CreateRequirementsAction) {
			String[] intList = { "CreateRequirementsEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof ReviewRequirementsAction) {
			String[] intList = { "ReviewRequirementsEffectRuleC",
					"ReviewRequirementsEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof CorrectRequirementsAction) {
			String[] intList = { "CorrectRequirementsEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof CreateDesignAction) {
			String[] intList = { "CreateDesignEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof ReviewDesignAction) {
			String[] intList = { "ReviewDesignEffectRuleA",
					"ReviewDesignEffectRuleC", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof CorrectDesignAction) {
			String[] intList = { "CorrectDesignEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof CreateCodeAction) {
			String[] trigList = {};
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
			String[] intList = { "CreateCodeEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof InspectCodeAction) {
			String[] intList = { "InspectCodeEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof CorrectCodeAction) {
			String[] intList = { "CorrectCodeEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof IntegrateCodeAction) {
			String[] intList = { "IntegrateCodeEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof SystemTestAction) {
			String[] intList = { "SystemTestEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof CreateSystemTestPlanAction) {
			String[] intList = { "CreateSystemTestPlanEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof ReviewSystemTestPlanAction) {
			String[] intList = { "ReviewTestPlanEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof CorrectSystemTestPlanAction) {
			String[] intList = { "CorrectTestPlanEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof DeliverProductAction) {
			String[] trigList = { "CalculateScore", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
		} else if (action instanceof BreakAction) {
			String[] trigList = { "BreakTrigRule", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
			String[] destList = { "BreakDestRule", };
//			destroyerRuleList.setListData(destList);
			intermediateRuleList.getItems().add(destList);
			String[] intList = { "BreakEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof GetSickAction) {
			String[] trigList = { "GetSickTrigRule", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
			String[] destList = { "GetSickDestRule", };
//			destroyerRuleList.setListData(destList);
			intermediateRuleList.getItems().add(destList);
			String[] intList = { "GetSickEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof QuitAction) {
			String[] trigList = { "QuitDestroyObjectsRuleA", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
		} else if (action instanceof IntroduceNewRequirementsAction) {
			String[] intList = { "IntroduceNewRequirementsEffectRuleA", };
//			intermediateRuleList.setListData(intList);
			intermediateRuleList.getItems().add(intList);
		} else if (action instanceof ChangePayRateAction) {
			String[] trigList = { "ChangePayRateEffectRuleA", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
		} else if (action instanceof GiveBonusAction) {
			String[] trigList = { "GiveBonusEffectRuleA", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
		} else if (action instanceof FireAction) {
			String[] trigList = { "FireDestroyObjectsRuleA", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
		} else if (action instanceof PurchaseToolAction) {
			String[] trigList = { "PurchaseToolEffectRuleA", };
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
		} else if (action instanceof SuggestedRequirementsPhaseDurationAction) {
			String[] trigList = {};
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
			String[] destList = {};
//			destroyerRuleList.setListData(destList);
			intermediateRuleList.getItems().add(destList);
		} else if (action instanceof SuggestedDesignPhaseDurationAction) {
			String[] trigList = {};
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
			String[] destList = {};
//			destroyerRuleList.setListData(destList);
			intermediateRuleList.getItems().add(destList);
		} else if (action instanceof SuggestedImplIntegrationPhaseDurationAction) {
			String[] trigList = {};
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
			String[] destList = {};
//			destroyerRuleList.setListData(destList);
			intermediateRuleList.getItems().add(destList);
		} else if (action instanceof SuggestedTestingPhaseDurationAction) {
			String[] trigList = {};
//			triggerRuleList.setListData(trigList);
			intermediateRuleList.getItems().add(trigList);
			String[] destList = {};
//			destroyerRuleList.setListData(destList);
			intermediateRuleList.getItems().add(destList);
		}
	}

	// refreshes the description area with the selected rule description
	private void refreshDescriptionArea() {
		String name = null;
		if (!triggerRuleList.getSelectionModel().isEmpty()) {
			name = (String) triggerRuleList.getSelectionModel().getSelectedItem();
		} else if (!destroyerRuleList.getSelectionModel().isEmpty()) {
			name = (String) destroyerRuleList.getSelectionModel().getSelectedItem();
		} else if (!intermediateRuleList.getSelectionModel().isEmpty()) {
			name = (String) intermediateRuleList.getSelectionModel().getSelectedItem();
		}
		if (name != null) {
			String text = "";
			if (action instanceof CreateRequirementsAction) {
				if (name.equals("CreateRequirementsEffectRuleA")) {
					text = RuleDescriptions.CREATEREQUIREMENTS_CREATEREQUIREMENTSEFFECTRULEA;
				}
			} else if (action instanceof ReviewRequirementsAction) {
				if (name.equals("ReviewRequirementsEffectRuleA")) {
					text = RuleDescriptions.REVIEWREQUIREMENTS_REVIEWREQUIREMENTSEFFECTRULEA;
				} else if (name.equals("ReviewRequirementsEffectRuleC")) {
					text = RuleDescriptions.REVIEWREQUIREMENTS_REVIEWREQUIREMENTSEFFECTRULEC;
				}
			} else if (action instanceof CorrectRequirementsAction) {
				if (name.equals("CorrectRequirementsEffectRuleA")) {
					text = RuleDescriptions.CORRECTREQUIREMENTS_CORRECTREQUIREMENTSEFFECTRULEA;
				}
			} else if (action instanceof CreateDesignAction) {
				if (name.equals("CreateDesignEffectRuleA")) {
					text = RuleDescriptions.CREATEDESIGN_CREATEDESIGNEFFECTRULEA;
				}
			} else if (action instanceof ReviewDesignAction) {
				if (name.equals("ReviewDesignEffectRuleA")) {
					text = RuleDescriptions.REVIEWDESIGN_REVIEWDESIGNEFFECTRULEA;
				} else if (name.equals("ReviewDesignEffectRuleC")) {
					text = RuleDescriptions.REVIEWDESIGN_REVIEWDESIGNEFFECTRULEC;
				}
			} else if (action instanceof CorrectDesignAction) {
				if (name.equals("CorrectDesignEffectRuleA")) {
					text = RuleDescriptions.CORRECTDESIGN_CORRECTDESIGNEFFECTRULEA;
				}
			} else if (action instanceof CreateCodeAction) {
				if (name.equals("CreateCodeEffectRuleA")) {
					text = RuleDescriptions.CREATECODE_CREATECODEEFFECTRULEA;
				}
			} else if (action instanceof InspectCodeAction) {
				if (name.equals("InspectCodeEffectRuleA")) {
					text = RuleDescriptions.INSPECTCODE_INSPECTCODEEFFECTRULEA;
				}
			} else if (action instanceof CorrectCodeAction) {
				if (name.equals("CorrectCodeEffectRuleA")) {
					text = RuleDescriptions.CORRECTCODE_CORRECTCODEEFFECTRULEA;
				}
			} else if (action instanceof IntegrateCodeAction) {
				if (name.equals("IntegrateCodeEffectRuleA")) {
					text = RuleDescriptions.INTEGRATECODE_INTEGRATECODEEFFECTRULEA;
				}
			} else if (action instanceof SystemTestAction) {
				if (name.equals("SystemTestEffectRuleA")) {
					text = RuleDescriptions.SYSTEMTEST_SYSTEMTESTEFFECTRULEA;
				}
			} else if (action instanceof CreateSystemTestPlanAction) {
				if (name.equals("CreateSystemTestPlanEffectRuleA")) {
					text = RuleDescriptions.CREATESYSTEMTESTPLAN_CREATESYSTEMTESTPLANEFFECTRULEA;
				}
			} else if (action instanceof ReviewSystemTestPlanAction) {
				if (name.equals("ReviewTestPlanEffectRuleA")) {
					text = RuleDescriptions.REVIEWSYSTEMTESTPLAN_REVIEWTESTPLANEFFECTRULEA;
				}
			} else if (action instanceof CorrectSystemTestPlanAction) {
				if (name.equals("CorrectTestPlanEffectRuleA")) {
					text = RuleDescriptions.CORRECTSYSTEMTESTPLAN_CORRECTTESTPLANEFFECTRULEA;
				}
			} else if (action instanceof DeliverProductAction) {
				if (name.equals("CalculateScore")) {
					text = RuleDescriptions.DELIVERPRODUCT_CALCULATESCORE;
				}
			} else if (action instanceof BreakAction) {
				if (name.equals("BreakEffectRuleA")) {
					text = RuleDescriptions.BREAK_BREAKEFFECTRULEA;
				} else if (name.equals("BreakTrigRule")) {
					text = RuleDescriptions.BREAK_BREAKTRIGRULE;
				} else if (name.equals("BreakDestRule")) {
					text = RuleDescriptions.BREAK_BREAKDESTRULE;
				}
			} else if (action instanceof GetSickAction) {
				if (name.equals("GetSickEffectRuleA")) {
					text = RuleDescriptions.GETSICK_GETSICKEFFECTRULEA;
				} else if (name.equals("GetSickTrigRule")) {
					text = RuleDescriptions.GETSICK_GETSICKTRIGRULE;
				} else if (name.equals("GetSickDestRule")) {
					text = RuleDescriptions.GETSICK_GETSICKDESTRULE;
				}
			} else if (action instanceof QuitAction) {
				if (name.equals("QuitDestroyObjectsRuleA")) {
					text = RuleDescriptions.QUIT_QUITDESTROYOBJECTSRULEA;
				}
			} else if (action instanceof IntroduceNewRequirementsAction) {
				if (name.equals("IntroduceNewRequirementsEffectRuleA")) {
					text = RuleDescriptions.INTRODUCENEWREQUIREMENTS_INTRODUCENEWREQUIREMENTSEFFECTRULEA;
				}
			} else if (action instanceof ChangePayRateAction) {
				if (name.equals("ChangePayRateEffectRuleA")) {
					text = RuleDescriptions.CHANGEPAYRATE_CHANGEPAYRATEEFFECTRULEA;
				}
			} else if (action instanceof GiveBonusAction) {
				if (name.equals("GiveBonusEffectRuleA")) {
					text = RuleDescriptions.GIVEBONUS_GIVEBONUSEFFECTRULEA;
				}
			} else if (action instanceof FireAction) {
				if (name.equals("FireDestroyObjectsRuleA")) {
					text = RuleDescriptions.FIRE_FIREDESTROYOBJECTSRULEA;
				}
			} else if (action instanceof PurchaseToolAction) {
				if (name.equals("PurchaseToolEffectRuleA")) {
					text = RuleDescriptions.PURCHASETOOL_PURCHASETOOLEFFECTRULEA;
				}
			} else if (action instanceof SuggestedRequirementsPhaseDurationAction) {
			} else if (action instanceof SuggestedDesignPhaseDurationAction) {
			} else if (action instanceof SuggestedImplIntegrationPhaseDurationAction) {
			} else if (action instanceof SuggestedTestingPhaseDurationAction) {
			}
			descriptionArea.setText(text);
			descriptionArea.positionCaret(0);
		}
	}

	@Override
	public void handle(MouseEvent event) {
		// TODO Auto-generated method stub
		
	}
}